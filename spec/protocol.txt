AutoItRPC protocol specification


RPC Messsage
 -------------------------------
| message_length | FS | message |
 -------------------------------

message_length
/^[0-9]+$/

Max: MAX_STRINGLEN

message
 ---------------------
| command | GS | args |
 ---------------------


args
 -------
| array |
 -------


Array Format (arr)
 ---------------------------------------------
| STX | value | RS | value | RS | value | ETX |
 ---------------------------------------------

Value Format
 ------------------------------
| STX | type | US | data | ETX |
 ------------------------------

e.g.
["blah", 24, false]

 -------------------------------------------------------------------------
| STX | STX | str | US | blah | ETX | RS | STX | i32 | US | 24 | ETX | RS |
 -------------------------------------------------------------------------

 ---------------------------------
| STX | bool | US | 1 | ETX | ETX |
 ---------------------------------

 

Supported Types
i32
i64
num
str
bool
hwnd
arr (STX)

Example Command Message
 ---------------------------------------------------------------------------
| 42 | FS | MouseClick | GS | STX | STX | str | US | left | ETX | RS | STX | 
 ---------------------------------------------------------------------------

 -------------------------------------------------------------------------
| i32 | US | 150 | ETX | RS | STX | int | US | 225 | ETX | RS | STX | i32 |
 -------------------------------------------------------------------------

 ---------------------
| US | 50 | ETX | ETX |
 ---------------------


Translates to
MouseClick("left", 150, 225, 50)


Result Format
 ----------------------------
| result_length | FS | value |
 ----------------------------

result_length
/^[1-9][0-9]+$/

Max: MAX_STRINGLEN



 Example Result From WinList()

 -----------------------------------------------------------------------------
| 50 | FS | STX | STX | STX | i32 | US | 1 | ETX | RS | STX | str | ETX | ETX |
 -----------------------------------------------------------------------------

 -------------------------------------------------------------------------
| STX | STX | str | US | Chrome | ETX | RS | STX | hwnd | US | 0xDEADBEEF |
 -------------------------------------------------------------------------

 -----------------
| ETX | ETX | ETX |
 -----------------

 Translates to
 [[1, ""], ["Chrome", "0xDEADBEEF"]]


 Example Result From PixelGetColor
 -------------------------------------------
| 12 | FS | STX | i32 | US | 16632256 | ETX |
 -------------------------------------------